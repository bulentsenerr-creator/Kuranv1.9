<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1220" />
  <title>Kurâ€™Ã¢n PWA v1.9</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">Ù‚</div>
      <div class="titles">
        <div class="app-title">Kurâ€™Ã¢n</div>
        <div class="app-subtitle">Modern â€¢ TÃ¼rkÃ§e â€¢ Ayet + Sayfa â€¢ v1.9</div>
      </div>
    </div>

    <div class="actions">
      <button id="btnContinue" class="btn ghost" title="KaldÄ±ÄŸÄ±n yer">â¤´ï¸</button>
      <button id="btnBookmarks" class="btn ghost" title="Yer imleri">ğŸ”–</button>
      <button id="btnOfflineMgr" class="btn ghost" title="Offline yÃ¶neticisi">â¬‡</button>
      <button id="btnTheme" class="btn ghost" title="Tema">ğŸŒ™</button>
      <button id="btnAbout" class="btn ghost" title="Kaynaklar">â“˜</button>
    </div>
  </header>

  <section class="controls">
    <div class="row">
      <div class="field">
        <label>Sure</label>
        <select id="surahSelect"></select>
      </div>

      <div class="field">
        <label>GÃ¶rÃ¼nÃ¼m</label>
        <div class="segmented">
          <button id="viewAyah" class="seg active">Ayet</button>
          <button id="viewPage" class="seg">Sayfa</button>
        </div>
      </div>

      <div class="field" id="pageField" hidden>
        <label>Sayfa</label>
        <div class="pageNav">
          <button id="prevPage" class="btn small">â—€</button>
          <select id="pageSelect"></select>
          <button id="nextPage" class="btn small">â–¶</button>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="field grow">
        <label>Meal (TÃ¼rkÃ§e)</label>
        <select id="translationSelect"></select>
        <div id="packWarning" class="hint" hidden>
          Bu meal iÃ§in bu surede <b>offline okuma paketi</b> yok. â€œMetin+Meal indirâ€ ile hazÄ±rlayabilirsiniz.
        </div>
      </div>

      <div class="field grow">
        <label>KÃ¢ri (Tilavet)</label>
        <select id="reciterSelect"></select>
      </div>
    </div>

    <div class="row">
      <div class="field grow">
        <label>Arama</label>
        <div class="searchRow">
          <select id="searchScope">
            <option value="surah">Sadece seÃ§ili sure</option>
            <option value="all">TÃ¼m Kurâ€™Ã¢n (meal)</option>
          </select>
          <input id="searchInput" class="input" placeholder="Ã–rn: rahmet, sabÄ±r, iman..." />
        </div>
        <div id="searchHint" class="hint" hidden>
          TÃ¼m Kurâ€™Ã¢n aramasÄ± iÃ§in meal verisi ilk kullanÄ±mda indirilecek ve cihazda saklanacaktÄ±r.
        </div>
      </div>

      <div class="field">
        <label>YazÄ± boyutu</label>
        <input id="fontSize" type="range" min="18" max="42" value="30" />
      </div>
    </div>

    <div class="row">
      <div class="field grow">
        <label>Ezber / Tekrar modu</label>
        <div class="repeatGrid">
          <div>
            <div class="muted tiny">BaÅŸlangÄ±Ã§</div>
            <input id="repStart" type="number" min="1" value="1" />
          </div>
          <div>
            <div class="muted tiny">BitiÅŸ</div>
            <input id="repEnd" type="number" min="1" value="7" />
          </div>
          <div>
            <div class="muted tiny">Tekrar</div>
            <input id="repCount" type="number" min="1" max="50" value="3" />
          </div>
          <div>
            <div class="muted tiny">Bekleme (sn)</div>
            <input id="repDelay" type="number" min="0" max="10" value="1" />
          </div>
          <div class="repeatBtns">
            <button id="btnRepeat" class="btn">âŸ² BaÅŸlat</button>
            <button id="btnStop" class="btn ghost">â–  Durdur</button>
          </div>
          <div class="toggles">
            <label class="chk"><input id="hideTr" type="checkbox" /> Meali gizle</label>
            <label class="chk"><input id="hideAr" type="checkbox" /> ArapÃ§ayÄ± gizle</label>
          </div>
        </div>
        <div class="muted tiny" style="margin-top:6px">
          Ä°pucu: iOSâ€™ta ses oynatma kullanÄ±cÄ± etkileÅŸimiyle baÅŸlar. â€œâŸ² BaÅŸlatâ€ veya â€œâ–¶ Dinleâ€ ile baÅŸlatÄ±n.
        </div>
      </div>
    </div>

    <div class="row">
      <div class="field grow">
        <label>Offline (v1.9: Kuyruk + CÃ¼zler + Paralel)</label>
        <div class="offlineRow">
          <button id="btnDownloadAudio" class="btn">â¬‡ Ses indir (bu sure)</button>
          <button id="btnClearAudio" class="btn ghost">ğŸ§¹ Ses sil</button>
        </div>
        <div class="offlineRow" style="margin-top:10px">
          <button id="btnDownloadText" class="btn">â¬‡ Metin+Meal indir (bu sure)</button>
          <button id="btnClearText" class="btn ghost">ğŸ§¹ Metin+Meal sil</button>
        </div>
        <div class="offlineRow" style="margin-top:10px">
          <button id="btnDownloadAllText" class="btn">â¬‡ TÃ¼m Kurâ€™Ã¢n Metin+Meal indir</button>
          <button id="btnCancelAllText" class="btn ghost" disabled>âœ‹ Ä°ptal</button>
          <button id="btnClearAllText" class="btn ghost">ğŸ§¹ TÃ¼m Kurâ€™Ã¢n Metin+Meal sil</button>
        </div>

        <div class="offlineRow" style="margin-top:10px">
          <button id="btnDownloadAllAudio" class="btn">â¬‡ TÃ¼m Kurâ€™Ã¢n Ses indir (kÃ¢ri)</button>
          <button id="btnPauseAllAudio" class="btn ghost" disabled>â¸ Duraklat</button>
          <button id="btnResumeAllAudio" class="btn ghost" disabled>â–¶ Devam</button>
          <button id="btnCancelAllAudio" class="btn ghost" disabled>âœ‹ Ä°ptal</button>
          <button id="btnClearAllAudio" class="btn ghost">ğŸ§¹ TÃ¼m Kurâ€™Ã¢n Ses sil (kÃ¢ri)</button>
        </div>

        <div class="offlineRow" style="margin-top:10px">
          <select id="juzSelect" style="min-width:140px"></select>
          <button id="btnDownloadJuzAudio" class="btn">â¬‡ CÃ¼z Ses indir</button>
          <button id="btnPauseJuzAudio" class="btn ghost" disabled>â¸ Duraklat</button>
          <button id="btnResumeJuzAudio" class="btn ghost" disabled>â–¶ Devam</button>
          <button id="btnCancelJuzAudio" class="btn ghost" disabled>âœ‹ Ä°ptal</button>
          <button id="btnClearJuzAudio" class="btn ghost">ğŸ§¹ CÃ¼z Ses sil</button>
        </div>

        <div class="offlineRow" style="margin-top:10px">
          <button id="btnEnqueueAllJuzAudio" class="btn">ğŸ“¥ TÃ¼m CÃ¼zleri KuyruÄŸa Ekle</button>
          <button id="btnCancelAllJuzJobs" class="btn ghost">âœ‹ TÃ¼m CÃ¼z Ä°ÅŸlerini Ä°ptal Et</button>
        </div>
        <div id="allJuzSummary" class="hint" hidden></div>

        <div id="dlStatus" class="dlStatus" hidden>
          <div class="bar"><div id="dlBar" class="barFill"></div></div>
          <div id="dlText" class="muted" style="margin-top:8px">HazÄ±rlanÄ±yorâ€¦</div>
        </div>

        <div id="txtStatus" class="dlStatus" hidden>
          <div class="bar"><div id="txtBar" class="barFill"></div></div>
          <div id="txtText" class="muted" style="margin-top:8px">HazÄ±rlanÄ±yorâ€¦</div>
        </div>

        <div id="allTxtStatus" class="dlStatus" hidden>
          <div class="bar"><div id="allTxtBar" class="barFill"></div></div>
          <div id="allTxtText" class="muted" style="margin-top:8px">HazÄ±rlanÄ±yorâ€¦</div>
        </div>

        <div id="allAudStatus" class="dlStatus" hidden>
          <div class="bar"><div id="allAudBar" class="barFill"></div></div>
          <div id="allAudText" class="muted" style="margin-top:8px">HazÄ±rlanÄ±yorâ€¦</div>
        </div>

        <div id="juzAudStatus" class="dlStatus" hidden>
          <div class="bar"><div id="juzAudBar" class="barFill"></div></div>
          <div id="juzAudText" class="muted" style="margin-top:8px">HazÄ±rlanÄ±yorâ€¦</div>
        </div>

        <div id="offlineBadge" class="hint" hidden></div>
      </div>
    </div>
  </section>

  <main class="content">
    <div id="status" class="status">YÃ¼kleniyorâ€¦</div>
    <div id="list" class="list"></div>
  </main>

  <!-- Bookmarks Modal -->
  <dialog id="bmDialog" class="modal">
    <div class="modal-header">
      <div>
        <h3>Yer Ä°mleri</h3>
        <p class="muted">Kaydedilen ayetler (cihazda saklanÄ±r).</p>
      </div>
      <button id="closeBm" class="btn ghost">âœ•</button>
    </div>
    <div class="modal-body">
      <div id="bmList" class="list"></div>
    </div>
  </dialog>

  <!-- Offline Manager Modal -->
  <dialog id="offDialog" class="modal">
    <div class="modal-header">
      <div>
        <h3>Offline YÃ¶neticisi</h3>
        <p class="muted">Ses paketleri (Cache) + Okuma paketleri (Metin+Meal) â€¢ Boyutlar yaklaÅŸÄ±k gÃ¶sterilir.</p>
      </div>
      <button id="closeOff" class="btn ghost">âœ•</button>
    </div>
    <div class="modal-body">
      <div class="card">
        <div class="tools" style="justify-content:space-between; align-items:center">
          <button id="btnRefreshSizes" class="btn">ğŸ“ BoyutlarÄ± yenile</button>
          <button id="btnRefreshQuota" class="btn">ğŸ’¾ Depolama durumunu yenile</button>
          <button id="btnClearAllOfflineAudio" class="btn ghost">ğŸ§¹ TÃ¼m offline SES paketlerini sil</button>
          <button id="btnClearAllOfflineText" class="btn ghost">ğŸ§¹ TÃ¼m offline OKUMA paketlerini sil</button>
        </div>
        <div id="sizeSummary" class="hint" style="margin-top:10px" hidden></div>
        <div id="quotaSummary" class="hint" style="margin-top:6px" hidden></div>

        <div class="tools" style="margin-top:10px; gap:10px; flex-wrap:wrap">
          <div style="min-width:240px">
            <label class="muted tiny" style="display:block; margin-bottom:6px">EÅŸzamanlÄ± indirme (job) sayÄ±sÄ±</label>
            <select id="maxConcurrentDownloads">
              <option value="1">1 (GÃ¼venli)</option>
              <option value="2">2 (Ã–nerilen)</option>
              <option value="3">3 (HÄ±zlÄ±)</option>
            </select>
          </div>
        </div>

        <label class="chk" style="margin-top:10px; display:flex; gap:8px; align-items:center">
          <input id="autoResumeJobs" type="checkbox" /> Uygulama aÃ§Ä±lÄ±nca indirmeleri otomatik devam ettir (Wiâ€‘Fi uyarÄ±lÄ±)
        </label>
        <label class="chk" style="margin-top:10px; display:flex; gap:8px; align-items:center">
          <input id="wifiOnlyDownloads" type="checkbox" /> BÃ¼yÃ¼k indirmeler sadece Wiâ€‘Fi ile Ã§alÄ±ÅŸsÄ±n (zorunlu)
        </label>
      </div>

      <div class="card">
        <h4 style="margin:0 0 8px">Ses Paketleri</h4>
        <div id="offAudioList" class="list"></div>
      </div>

      <div class="card">
        <div class="tools" style="justify-content:space-between; align-items:center; margin-bottom:8px">
          <h4 style="margin:0">Okuma Paketleri (Metin+Meal)</h4>
          <div style="min-width: 320px">
            <select id="textPackFilter"></select>
          </div>
        </div>
        <div id="offTextList" class="list"></div>
      </div>

      <div class="card">
        <h4 style="margin:0 0 8px">Ä°ndirme KuyruÄŸu</h4>
        <div id="jobList" class="list"></div>
      </div>
    </div>
  </dialog>

  <!-- Global search download modal -->
  <dialog id="dlQDialog" class="modal">
    <div class="modal-header">
      <div>
        <h3>Arama verisi indiriliyor</h3>
        <p class="muted">SeÃ§ili TÃ¼rkÃ§e meal, tÃ¼m Kurâ€™Ã¢n iÃ§in cihazÄ±nÄ±za kaydediliyor.</p>
      </div>
      <button id="closeDlQ" class="btn ghost">âœ•</button>
    </div>
    <div class="modal-body">
      <div class="bar"><div id="qBar" class="barFill"></div></div>
      <div id="qText" class="muted" style="margin-top:10px">BaÅŸlÄ±yorâ€¦</div>
    </div>
  </dialog>

  <!-- About Modal -->
  <dialog id="aboutDialog" class="modal">
    <div class="modal-header">
      <div>
        <h3>Kaynaklar & AtÄ±flar</h3>
        <p class="muted">Bu uygulama v1.9, metin/meal/ses verisini APIâ€™lerden Ã§eker ve offline iÃ§in Ã¶nbellekler.</p>
      </div>
      <button id="closeAbout" class="btn ghost">âœ•</button>
    </div>
    <div class="modal-body">
      <div class="card">
        <h4>API</h4>
        <p class="muted">alquran.cloud API uÃ§ noktalarÄ±: Surah / Quran / Juz.</p>
      </div>
      <div class="card">
        <h4>Not</h4>
        <p class="muted">Paralel indirme sayÄ±sÄ±nÄ± 2 Ã¶neriyoruz. iOS arka planda indirmeyi durdurabilir; bu nedenle iÅŸler yeniden aÃ§Ä±lÄ±ÅŸta â€œpausedâ€ olabilir.</p>
      </div>
    </div>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
